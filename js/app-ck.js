$(document).ready(function(){function a(){var s=0,o=Number($(".iva").val())/100,u=Number($(".irpf").val())/100;$("#invoice-table > tbody > tr.row").each(function(){e=$(this).find("input.cantidad").val();t=$(this).find("input.coste").val();n=+t*+e;$(this).find(".precio").text(n);$(this).find(".precio-hidden").val(n);s+=n});r=f(s*o);i=f(s*u);total=s+r+i;$(".subtotal").text(s);$(".totaliva").text(r);$(".totalirpf").text(i);$(".total").text(f(total));$(".subtotal-hidden").val(s);$(".totaliva-hidden").val(r);$(".totalirpf-hidden").val(i);$(".total-hidden").val(f(total))}function f(e){return Math.round(e*100)/100}function l(){localStorage.name=$("#name").val();localStorage.email=$("#email").val();localStorage.tel=$("#tel").val();localStorage.invoice_num=$("#inv").val();localStorage.description=$("input.description").val();localStorage.quantity=e;localStorage.cost=t;localStorage.price=n;localStorage.totaliva=r;localStorage.totalirpf=i;localStorage.subtotal=$(".subtotal").text();localStorage.total=$(".total").text();h()}function c(){$("#name").val(localStorage.name);$("#email").val(localStorage.email);$("#tel").val(localStorage.tel);$("#inv").val(localStorage.invoice_num);$("input.description").val(localStorage.description);$(".cantidad").val(localStorage.quantity);$(".coste").val(localStorage.cost);$(".precio").text(localStorage.price);$(".totaliva").text(localStorage.totaliva);$(".totalirpf").text(localStorage.totalirpf);$(".subtotal").text(localStorage.subtotal);$(".total").text(localStorage.total)}function h(){$(".row").each(function(e,t){s[e]={description:$("input.description").eq(e).val(),cantidad:$(".cantidad").eq(e).val(),coste:$(".coste").eq(e).val(),precio:$(".precio").eq(e).text()}});for(var e in s)console.log(s[e])}var e=0,t=0,n=0,r=0,i=0,s=new Array;c();$("#descargar").click(function(){row_html=$("tbody").html();$(".html-hidden").val(row_html);return!0});$("#guardar").click(function(e){l();return!1});var o=1,u="<tr class='row'><td class='article'><input class='description' type='text' name='description-value' size='40' placeholder='ej. PÃ¡gina web' value=''/><input class='hidden-description' type='hidden' value=''/></td><td><input class='cantidad' type='text' name='cost' placeholder='Cant.' size='2' value='0'/></td><td><input class='coste' type='text' name='qty' placeholder='Coste' size='2' value='0'/></td><td class='value'><span class='precio'>0</span><input class='precio-hidden' type='hidden' name='price' value='0'/></td><td class='insert'><a class='delete-row' href='#'>Delete Row</a></td></tr>";$(".add-row").on("click",function(e){o++;$("#invoice-table > tbody > tr.row:last").after(u);e.preventDefault()});$("#invoice-table").on("click",".delete-row",function(e){var t=$(this).closest("tr");if(o>1){o--;t.remove();a()}else alert("You can't delete the only row!");e.preventDefault()});$("#invoice-table").on("input",function(e){$("div input").each(function(){$(this).keyup(function(){$(this).attr("value",$(this).val())})});e.target.className!=="description"&&a()})});