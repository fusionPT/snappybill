var Glyph={glyphs:[],ratio:null,head:null,os2:null,hmtx:null,width:null,height:null,scale:1,splitPath:function(e){return e.match(/([a-z])|(-?\d+(?:\.\d+)?)/ig)},drawPath:function(e,t){var n=Glyph.splitPath(t);if(!n)return;var r=n.length,i=0;e.beginPath();while(i<r){var s=n[i];switch(s){case"M":e.moveTo(n[++i],n[++i]);break;case"L":e.lineTo(n[++i],n[++i]);break;case"Q":e.quadraticCurveTo(n[++i],n[++i],n[++i],n[++i]);break;case"z":i++;break;default:i++}}e.fill();e.closePath()},drawSVGContours:function(e,t){if(!$.isArray(t)){Glyph.drawPath(e,t);return}var n,r,i;for(var s=0,o=t.length;s<o;s++){n=t[s];r=n.contours;i=n.transform;e.save();e.transform(i[0],i[1],i[2],i[3],i[4],i[5]);Glyph.drawSVGContours(e,r);e.restore()}},drawHorizLine:function(e,t,n){e.beginPath();e.strokeStyle=n;e.moveTo(0,t);e.lineTo(Glyph.width*Glyph.ratio,t);e.closePath();e.stroke()},draw:function(e,t,n){var r=e[0],i=r.getContext("2d"),s=Glyph.ratio,o=Glyph.width*Glyph.scale,u=Glyph.height*Glyph.scale;i.clearRect(0,0,o,u);i.lineWidth=s/Glyph.scale;i.translate(0,u);i.scale(1/s,-(1/s));i.scale(Glyph.scale,Glyph.scale);i.translate(0,-Glyph.head.yMin);Glyph.drawHorizLine(i,0,"rgba(0,255,0,0.2)");Glyph.drawHorizLine(i,Glyph.os2.typoAscender,"rgba(255,0,0,0.2)");Glyph.drawHorizLine(i,-Math.abs(Glyph.os2.typoDescender),"rgba(255,0,0,0.2)");i.translate(-Glyph.head.xMin,0);i.save();var a=s*3;i.strokeStyle="rgba(0,0,0,0.5)";i.lineWidth=s*1.5/Glyph.scale;i.beginPath();i.moveTo(-a,-a);i.lineTo(+a,+a);i.moveTo(+a,-a);i.lineTo(-a,+a);i.closePath();i.stroke();var f=Glyph.hmtx[n][0];i.beginPath();i.moveTo(-a+f,-a);i.lineTo(+a+f,+a);i.moveTo(+a+f,-a);i.lineTo(-a+f,+a);i.closePath();i.stroke();i.restore();if(!t)return;i.beginPath();i.strokeStyle="rgba(0,0,0,0.3)";i.rect(0,0,t.xMin+t.xMax,t.yMin+t.yMax);i.closePath();i.stroke();i.strokeStyle="black";Glyph.drawSVGContours(i,t.SVGContours)},drawAll:function(){$.each(Glyph.glyphs,function(e,t){Glyph.draw($("#glyph-canvas-"+t[0]),t[1],t[0])})},resize:function(e){Glyph.scale=e/100;$.each(document.getElementsByTagName("canvas"),function(e,t){t.height=Glyph.height*Glyph.scale;t.width=Glyph.width*Glyph.scale});Glyph.drawAll()}};$(function(){Glyph.drawAll()});